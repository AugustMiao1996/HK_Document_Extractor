# 🕸️ 单案件知识图谱系统使用说明

## 🎯 **系统特点**

### ✅ **解决的问题**
- **修复了原系统端口8050无法访问的问题** → 使用端口8051
- **修复了节点创建失败的问题** → 智能清理空值和异常数据
- **实现了单案件专注展示** → 清晰的案件内部关系图

### 🚀 **核心功能**
- **案件选择界面**：表格形式浏览所有案件，支持搜索
- **单案件知识图谱**：专注展示一个案件的完整关系网络
- **交互式图谱**：支持节点点击、关系筛选、布局调整
- **详情查看**：点击节点查看完整信息

## 📋 **快速开始**

### 1. **启动系统**
```bash
cd HK_Document_Extractor
python start_single_case_graph.py
```

### 2. **访问界面**
打开浏览器访问：`http://127.0.0.1:8051`

### 3. **使用流程**
1. **选择案件**：在"案件选择"tab中浏览案件列表
2. **搜索筛选**：使用搜索框快速找到目标案件
3. **选中案件**：点击表格行选中案件
4. **分析案件**：点击"分析选中案件"按钮
5. **查看图谱**：自动跳转到"知识图谱"tab
6. **交互操作**：拖拽、点击、筛选关系

## 🎨 **图谱元素说明**

### 🎯 **节点类型**
- **🔵 案件节点**（蓝色，最大）：案件核心信息
- **🟢 原告节点**（绿色）：起诉方当事人
- **🔴 被告节点**（红色）：被起诉方当事人
- **🟣 法官节点**（紫色）：审理法官
- **⚫ 法院节点**（灰色）：审理法院
- **🟤 律师节点**（棕色）：代理律师
- **🟡 律师事务所**（粉色）：律师所属机构
- **🟠 金额节点**（橙色）：涉及金额信息

### 🔗 **关系类型**
- **起诉关系**：原告起诉被告
- **参与案件**：当事人参与案件
- **法官审理**：法官审理案件
- **法院审理**：法院受理案件
- **律师代理**：律师参与案件
- **涉及金额**：案件涉及的金额

## 🛠️ **控制功能**

### 📐 **布局调整**
- **力导向布局**：自然的关系展示，适合复杂关系
- **分层布局**：层次化显示，适合明确等级关系
- **圆形布局**：环形排列，适合展示中心关系
- **网格布局**：规整排列，适合对比查看

### 🎛️ **关系筛选**
可以选择性显示/隐藏不同类型的关系：
- ✅ 起诉关系
- ✅ 参与案件
- ✅ 法官审理
- ✅ 法院审理
- ✅ 律师代理
- ✅ 涉及金额

### 🔍 **详情查看**
- **点击节点**：查看节点详细信息
- **案件信息**：显示完整案件数据
- **当事人信息**：显示角色和基本信息
- **律师信息**：显示代理关系

## 📊 **数据覆盖**

### 支持的案件信息
- **基本信息**：案件号、文件名、审理日期
- **当事人**：原告、被告（支持多方）
- **法律人员**：法官、律师、律师事务所
- **案件详情**：案件类型、判决结果
- **金额信息**：申请金额、判决金额
- **法院信息**：审理法院

### 数据清理功能
- **自动过滤空值**：移除空白和"unknown"数据
- **智能解析多方**：正确处理多个原告/被告
- **律师信息提取**：从复杂文本中提取律师和事务所
- **异常数据处理**：过滤异常格式的数据

## 🔧 **技术特点**

### 🚀 **性能优化**
- **按需加载**：只为选中案件生成图谱
- **前端渲染**：使用Dash + Cytoscape高性能渲染
- **智能缓存**：避免重复数据处理

### 🛡️ **稳定性**
- **错误处理**：完善的异常处理机制
- **数据验证**：多层数据清理和验证
- **容错设计**：即使部分数据有问题也能正常工作

### 🎯 **用户体验**
- **直观界面**：清晰的两步操作流程
- **响应式设计**：适配不同屏幕尺寸
- **即时反馈**：操作结果立即可见

## 🆚 **与原系统对比**

| 功能 | 原系统 | 新系统 |
|------|--------|--------|
| 端口 | 8050（冲突） | 8051（正常） |
| 节点创建 | 失败（null值） | 成功（智能清理） |
| 图谱模式 | 全局大图谱 | 单案件专注 |
| 性能 | 加载所有数据 | 按需生成 |
| 清晰度 | 复杂混乱 | 清晰专注 |
| 用户体验 | 复杂操作 | 简单两步 |

## 📝 **使用建议**

### 🎯 **最佳实践**
1. **先搜索后选择**：使用搜索功能快速定位目标案件
2. **关系筛选**：根据分析需要选择性显示关系
3. **布局试验**：尝试不同布局找到最佳视角
4. **节点详情**：充分利用点击查看功能

### 🔍 **分析技巧**
- **关注中心**：案件节点是所有关系的核心
- **对抗关系**：原告-被告的起诉关系是主线
- **代理网络**：观察律师和事务所的代理关系
- **权威节点**：法官和法院体现司法权威

## 🆘 **常见问题**

### Q: 端口8051无法访问？
A: 检查防火墙设置，或者尝试使用`http://localhost:8051`

### Q: 图谱显示不完整？
A: 尝试关系筛选功能，确保所有关系类型都已选中

### Q: 节点信息显示"N/A"？
A: 这是正常现象，表示原始数据中该字段为空

### Q: 图谱布局混乱？
A: 尝试不同的布局算法，或者使用关系筛选简化显示

---

## 🎉 **开始使用**

现在您可以运行以下命令启动系统：

```bash
python start_single_case_graph.py
```

然后访问 `http://127.0.0.1:8051` 开始探索您的案件知识图谱！ 